34, "CR07", "Num", "Number of jobs for workers with Race: Two or More Race Groups",
35, "CT01", "Num", "Number of jobs for workers with Ethnicity: Not Hispanic or Latino",
36, "CT02", "Num", "Number of jobs for workers with Ethnicity: Hispanic or Latino",
37, "CD01", "Num", "Number of jobs for workers with Educational Attainment: Less than high school",
38, "CD02", "Num", "Number of jobs for workers with Educational Attainment: High school or equivalent, no college",
39, "CD03", "Num", "Number of jobs for workers with Educational Attainment: Some college or Associate degree",
40, "CD04", "Num", "Number of jobs for workers with Educational Attainment: Bachelor's degree or advanced degree",
41, "CS01", "Num", "Number of jobs for workers with Sex: Male",
42, "CS02", "Num", "Number of jobs for workers with Sex: Female",
43, "CFA01", "Num", "Number of jobs for workers at firms with Firm Age: 0-1 Years",
44, "CFA02", "Num", "Number of jobs for workers at firms with Firm Age: 2-3 Years",
45, "CFA03", "Num", "Number of jobs for workers at firms with Firm Age: 4-5 Years",
46, "CFA04", "Num", "Number of jobs for workers at firms with Firm Age: 6-10 Years",
47, "CFA05", "Num", "Number of jobs for workers at firms with Firm Age: 11+ Years",
48, "CFS01", "Num", "Number of jobs for workers at firms with Firm Size: 0-19 Employees",
49, "CFS02", "Num", "Number of jobs for workers at firms with Firm Size: 20-49 Employees",
50, "CFS03", "Num", "Number of jobs for workers at firms with Firm Size: 50-249 Employees",
51, "CFS04", "Num", "Number of jobs for workers at firms with Firm Size: 250-499 Employees",
52, "CFS05", "Num", "Number of jobs for workers at firms with Firm Size: 500+ Employees",
## OD-specific variables
53, "S000", "Num", "Total number of jobs",
54, "SA01", "Num", "Number of jobs for workers age 29 or younger",
55, "SA02", "Num", "Number of jobs for workers age 30 to 54",
56, "SA03", "Num", "Number of jobs for workers age 55 or older",
57, "SE01", "Num", "Number of jobs with earnings $1250/month or less",
58, "SE02", "Num", "Number of jobs with earnings $1251/month to $3333/month",
59, "SE03", "Num", "Number of jobs with earnings greater than $3333/month",
60, "SI01", "Num", "Number of jobs industry Goods Producing",
61, "SI02", "Num", "Number of jobs industry Trade, Transportation, Utilities",
62, "SI03", "Num", "Number of jobs industry All Other Services") %>%
dplyr::mutate(
Explanation = Explanation %>%
stringr::str_to_lower() %>%
stringr::str_replace_all(c(
" " = "_",
"-" = "_",
"[^[:alnum:]_]" = "",
"number_of_jobs" = "jobs",
"jobs_in_naics_sector_[0-9]{2}" = "jobs_industry",
"^jobs_[0-9]{2}" = "jobs",
"33_manufacturing" = "manufacturing",
"45_retail" = "retail",
"49_transportation" = "transportation")) %>%
stringr::str_remove_all("for_|with_|workers_at_firms_")) %>%
dplyr::filter(Variable %in% (.df %>% colnames()))
renaming_vector = stats::setNames(variable_metadata$Variable, variable_metadata$Explanation)
.df %>% dplyr::rename(!!!renaming_vector)
}
source("~/GitHub/climateapi/R/get_lodes.R", echo=TRUE)
test <- get_lodes()
getOption("browser")
options(browser = NULL)
getOption("browser")
test <- get_lodes()
source("~/GitHub/climateapi/R/get_lodes.R", echo=TRUE)
test <- get_lodes(lodes_type = "rac")
rename_lodes_variables = function(.df) {
## renaming code from GH Copilot (in small part--just translating the codebook to a tribble)
## variable definitions/metadata from: https://lehd.ces.census.gov/data/lodes/LODES7/LODESTechDoc7.2.pdf
## table of variable definitions
variable_metadata <- tibble::tribble(
~Pos, ~Variable, ~Type, ~Explanation,
1, "GEOID", "Char15", "GEOID",
2, "C000", "Num", "Total number of jobs",
3, "CA01", "Num", "Number of jobs for workers age 29 or younger",
4, "CA02", "Num", "Number of jobs for workers age 30 to 54",
5, "CA03", "Num", "Number of jobs for workers age 55 or older",
6, "CE01", "Num", "Number of jobs with earnings $1250/month or less",
7, "CE02", "Num", "Number of jobs with earnings $1251/month to $3333/month",
8, "CE03", "Num", "Number of jobs with earnings greater than $3333/month",
9, "CNS01", "Num", "Number of jobs in NAICS sector 11 (Agriculture, Forestry, Fishing and Hunting)",
10, "CNS02", "Num", "Number of jobs in NAICS sector 21 (Mining, Quarrying, and Oil and Gas Extraction)",
11, "CNS03", "Num", "Number of jobs in NAICS sector 22 (Utilities)",
12, "CNS04", "Num", "Number of jobs in NAICS sector 23 (Construction)",
13, "CNS05", "Num", "Number of jobs in NAICS sector 31-33 (Manufacturing)",
14, "CNS06", "Num", "Number of jobs in NAICS sector 42 (Wholesale Trade)",
15, "CNS07", "Num", "Number of jobs in NAICS sector 44-45 (Retail Trade)",
16, "CNS08", "Num", "Number of jobs in NAICS sector 48-49 (Transportation and Warehousing)",
17, "CNS09", "Num", "Number of jobs in NAICS sector 51 (Information)",
18, "CNS10", "Num", "Number of jobs in NAICS sector 52 (Finance and Insurance)",
19, "CNS11", "Num", "Number of jobs in NAICS sector 53 (Real Estate and Rental and Leasing)",
20, "CNS12", "Num", "Number of jobs in NAICS sector 54 (Professional, Scientific, and Technical Services)",
21, "CNS13", "Num", "Number of jobs in NAICS sector 55 (Management of Companies and Enterprises)",
22, "CNS14", "Num", "Number of jobs in NAICS sector 56 (Administrative and Support and Waste Management and Remediation Services)",
23, "CNS15", "Num", "Number of jobs in NAICS sector 61 (Educational Services)",
24, "CNS16", "Num", "Number of jobs in NAICS sector 62 (Health Care and Social Assistance)",
25, "CNS17", "Num", "Number of jobs in NAICS sector 71 (Arts, Entertainment, and Recreation)",
26, "CNS18", "Num", "Number of jobs in NAICS sector 72 (Accommodation and Food Services)",
27, "CNS19", "Num", "Number of jobs in NAICS sector 81 (Other Services [except Public Administration])",
28, "CNS20", "Num", "Number of jobs in NAICS sector 92 (Public Administration)",
29, "CR01", "Num", "Number of jobs for workers with Race: White, Alone",
30, "CR02", "Num", "Number of jobs for workers with Race: Black or African American Alone",
31, "CR03", "Num", "Number of jobs for workers with Race: American Indian or Alaska Native Alone",
32, "CR04", "Num", "Number of jobs for workers with Race: Asian Alone",
33, "CR05", "Num", "Number of jobs for workers with Race: Native Hawaiian or Other Pacific Islander Alone",
34, "CR07", "Num", "Number of jobs for workers with Race: Two or More Race Groups",
35, "CT01", "Num", "Number of jobs for workers with Ethnicity: Not Hispanic or Latino",
36, "CT02", "Num", "Number of jobs for workers with Ethnicity: Hispanic or Latino",
37, "CD01", "Num", "Number of jobs for workers with Educational Attainment: Less than high school",
38, "CD02", "Num", "Number of jobs for workers with Educational Attainment: High school or equivalent, no college",
39, "CD03", "Num", "Number of jobs for workers with Educational Attainment: Some college or Associate degree",
40, "CD04", "Num", "Number of jobs for workers with Educational Attainment: Bachelor's degree or advanced degree",
41, "CS01", "Num", "Number of jobs for workers with Sex: Male",
42, "CS02", "Num", "Number of jobs for workers with Sex: Female",
43, "CFA01", "Num", "Number of jobs for workers at firms with Firm Age: 0-1 Years",
44, "CFA02", "Num", "Number of jobs for workers at firms with Firm Age: 2-3 Years",
45, "CFA03", "Num", "Number of jobs for workers at firms with Firm Age: 4-5 Years",
46, "CFA04", "Num", "Number of jobs for workers at firms with Firm Age: 6-10 Years",
47, "CFA05", "Num", "Number of jobs for workers at firms with Firm Age: 11+ Years",
48, "CFS01", "Num", "Number of jobs for workers at firms with Firm Size: 0-19 Employees",
49, "CFS02", "Num", "Number of jobs for workers at firms with Firm Size: 20-49 Employees",
50, "CFS03", "Num", "Number of jobs for workers at firms with Firm Size: 50-249 Employees",
51, "CFS04", "Num", "Number of jobs for workers at firms with Firm Size: 250-499 Employees",
52, "CFS05", "Num", "Number of jobs for workers at firms with Firm Size: 500+ Employees",
## OD-specific variables
53, "S000", "Num", "Total number of jobs",
54, "SA01", "Num", "Number of jobs for workers age 29 or younger",
55, "SA02", "Num", "Number of jobs for workers age 30 to 54",
56, "SA03", "Num", "Number of jobs for workers age 55 or older",
57, "SE01", "Num", "Number of jobs with earnings $1250/month or less",
58, "SE02", "Num", "Number of jobs with earnings $1251/month to $3333/month",
59, "SE03", "Num", "Number of jobs with earnings greater than $3333/month",
60, "SI01", "Num", "Number of jobs industry Goods Producing",
61, "SI02", "Num", "Number of jobs industry Trade, Transportation, Utilities",
62, "SI03", "Num", "Number of jobs industry All Other Services") %>%
dplyr::mutate(
Explanation = Explanation %>%
stringr::str_to_lower() %>%
stringr::str_replace_all(c(
" " = "_",
"-" = "_",
"[^[:alnum:]_]" = "",
"number_of_jobs" = "jobs",
"jobs_in_naics_sector_[0-9]{2}" = "jobs_industry",
"^jobs_[0-9]{2}" = "jobs",
"33_manufacturing" = "manufacturing",
"45_retail" = "retail",
"49_transportation" = "transportation")) %>%
stringr::str_remove_all("for_|with_|workers_at_firms_")) %>%
dplyr::filter(Variable %in% (.df %>% colnames()))
renaming_vector = stats::setNames(variable_metadata$Variable, variable_metadata$Explanation)
.df %>% dplyr::rename(!!!renaming_vector)
}
test <- get_lodes(lodes_type = "rac")
library(tidyverse)
test <- get_lodes(lodes_type = "rac")
test <- get_lodes(lodes_type = "rac", years = 2021)
options(browser = NULL)
test <- get_lodes(lodes_type = "rac", years = 2021)
options(browser = "false")
test <- get_lodes(lodes_type = "rac", years = 2021)
test <- get_lodes(lodes_type = "rac", years = 2021, states = "MN")
R.home()
Sys.getenv("R_PROFILE_USER")
R.home()
Sys.getenv("R_PROFILE_USER")
Sys.getenv("R_PROFILE_USER")
options(error = NULL)
test <- get_lodes(lodes_type = "rac", years = 2021, states = "MN")
rlang::last_trace()
source("~/GitHub/climateapi/R/get_lodes.R")
test <- get_lodes(lodes_type = "rac", years = 2021, states = "MN")
## both all jobs and all federal jobs
lodes_all_nonfederal_jobs = lodes_all_jobs %>%
dplyr::rename_with(.cols = -c(year, dplyr::matches("GEOID"), state), .fn = ~ stringr::str_c("all_", .x)) %>%
dplyr::mutate(year = as.numeric(year)) %>%
dplyr::left_join(
lodes_federal_jobs %>%
dplyr::select(-state) %>%
dplyr::rename_with(.cols = -c(year, dplyr::matches("GEOID")), .fn = ~ stringr::str_c("federal_", .x)) %>%
dplyr::mutate(year = as.numeric(year)),
by = join_by) %>%
dplyr::mutate(
dplyr::across(
## there are many fewer rows for the federal primary jobs data, so the join
## produces NAs for federal jobs for many tracts. however, these tracts in
## effect have zero federal jobs, so we replace the NAs with zeros.
.cols = dplyr::matches("federal"),
.fns = ~ dplyr::if_else(is.na(.x), 0, .x)),
## no federal data exists for years prior to 2010
dplyr::across(
.cols = dplyr::matches("federal"),
.fns = ~ dplyr::if_else(year < 2010, NA_real_, .x))) %>%
tidyr::pivot_longer(
cols = -c(year, state, dplyr::matches("GEOID")),
names_pattern = "(all|federal)_(.*)",
names_to = c("job_type", "variable")) %>%
tidyr::pivot_wider(names_from = "variable", values_from = value) %>%
rename_lodes_variables()
## both all jobs and all federal jobs
lodes_all_nonfederal_jobs = lodes_all_jobs %>%
dplyr::rename_with(.cols = -c(year, dplyr::matches("GEOID"), state), .fn = ~ stringr::str_c("all_", .x)) %>%
dplyr::mutate(year = as.numeric(year)) %>%
dplyr::left_join(
lodes_federal_jobs %>%
dplyr::select(-state) %>%
dplyr::rename_with(.cols = -c(year, dplyr::matches("GEOID")), .fn = ~ stringr::str_c("federal_", .x)) %>%
dplyr::mutate(year = as.numeric(year)),
by = join_by) %>%
dplyr::mutate(
dplyr::across(
## there are many fewer rows for the federal primary jobs data, so the join
## produces NAs for federal jobs for many tracts. however, these tracts in
## effect have zero federal jobs, so we replace the NAs with zeros.
.cols = dplyr::matches("federal"),
.fns = ~ dplyr::if_else(is.na(.x), 0, .x)),
## no federal data exists for years prior to 2010
dplyr::across(
.cols = dplyr::matches("federal"),
.fns = ~ dplyr::if_else(year < 2010, NA_real_, .x))) %>%
tidyr::pivot_longer(
cols = -c(year, state, dplyr::matches("GEOID")),
names_pattern = "(all|federal)_(.*)",
names_to = c("job_type", "variable")) %>%
tidyr::pivot_wider(names_from = "variable", values_from = value) #%>%
View(lodes_federal_jobs)
View(lodes_all_jobs)
source("~/GitHub/climateapi/R/get_lodes.R")
source("~/GitHub/climateapi/R/get_lodes.R")
test <- get_lodes(lodes_type = "rac", years = 2021, states = "MN")
source("~/GitHub/climateapi/R/get_lodes.R")
test <- get_lodes(lodes_type = "rac", years = 2021, states = "MN")
## both all jobs and all federal jobs
lodes_all_nonfederal_jobs = lodes_all_jobs %>%
dplyr::rename_with(.cols = -c(year, dplyr::matches("GEOID"), state), .fn = ~ stringr::str_c("all_", .x)) %>%
dplyr::mutate(year = as.numeric(year)) #%>%
View(lodes_all_nonfederal_jobs)
lodes_federal_jobs %>%
dplyr::select(-state) %>%
dplyr::rename_with(.cols = -c(year, dplyr::matches("GEOID")), .fn = ~ stringr::str_c("federal_", .x)) %>%
dplyr::mutate(year = as.numeric(year))
## both all jobs and all federal jobs
lodes_all_nonfederal_jobs = lodes_all_jobs %>%
dplyr::rename_with(.cols = -c(year, dplyr::matches("GEOID"), state), .fn = ~ stringr::str_c("all_", .x)) %>%
dplyr::mutate(year = as.numeric(year)) %>%
dplyr::left_join(
lodes_federal_jobs %>%
dplyr::select(-state) %>%
dplyr::rename_with(.cols = -c(year, dplyr::matches("GEOID")), .fn = ~ stringr::str_c("federal_", .x)) %>%
dplyr::mutate(year = as.numeric(year)),
by = join_by) %>%
dplyr::mutate(
dplyr::across(
## there are many fewer rows for the federal primary jobs data, so the join
## produces NAs for federal jobs for many tracts. however, these tracts in
## effect have zero federal jobs, so we replace the NAs with zeros.
.cols = dplyr::matches("federal"),
.fns = ~ dplyr::if_else(is.na(.x), 0, .x)),
## no federal data exists for years prior to 2010
dplyr::across(
.cols = dplyr::matches("federal"),
.fns = ~ dplyr::if_else(year < 2010, NA_real_, .x))) %>%
tidyr::pivot_longer(
cols = -c(year, state, dplyr::matches("GEOID")),
names_pattern = "(all|federal)_(.*)",
names_to = c("job_type", "variable")) %>%
tidyr::pivot_wider(names_from = "variable", values_from = value) %>%
rename_lodes_variables()
if (lodes_type == "od") {
join_by = c("year", "w_GEOID", "h_GEOID") }
if (lodes_type == "od") {
join_by = c("year", "w_GEOID", "h_GEOID") }
if (lodes_type == "od") {
join_by = c("year", "w_GEOID", "h_GEOID")
else if (lodes_type == "rac")
if (lodes_type == "od") {
join_by = c("year", "w_GEOID", "h_GEOID") } else if (lodes_type == "rac")
if (lodes_type == "od") {
join_by = c("year", "w_GEOID", "h_GEOID") } else if (lodes_type == "rac") {
join_by = c("year", "h_GEOID")
}
## both all jobs and all federal jobs
lodes_all_nonfederal_jobs = lodes_all_jobs %>%
dplyr::rename_with(.cols = -c(year, dplyr::matches("GEOID"), state), .fn = ~ stringr::str_c("all_", .x)) %>%
dplyr::mutate(year = as.numeric(year)) %>%
dplyr::left_join(
lodes_federal_jobs %>%
dplyr::select(-state) %>%
dplyr::rename_with(.cols = -c(year, dplyr::matches("GEOID")), .fn = ~ stringr::str_c("federal_", .x)) %>%
dplyr::mutate(year = as.numeric(year)),
by = join_by) %>%
dplyr::mutate(
dplyr::across(
## there are many fewer rows for the federal primary jobs data, so the join
## produces NAs for federal jobs for many tracts. however, these tracts in
## effect have zero federal jobs, so we replace the NAs with zeros.
.cols = dplyr::matches("federal"),
.fns = ~ dplyr::if_else(is.na(.x), 0, .x)),
## no federal data exists for years prior to 2010
dplyr::across(
.cols = dplyr::matches("federal"),
.fns = ~ dplyr::if_else(year < 2010, NA_real_, .x))) %>%
tidyr::pivot_longer(
cols = -c(year, state, dplyr::matches("GEOID")),
names_pattern = "(all|federal)_(.*)",
names_to = c("job_type", "variable")) %>%
tidyr::pivot_wider(names_from = "variable", values_from = value) %>%
rename_lodes_variables()
source("~/GitHub/climateapi/R/get_lodes.R")
test <- get_lodes(lodes_type = "rac", years = 2021, states = "MN")
test2 <- get_lodes(lodes_type = "wac", years = 2021, states = "MN")
test2 <- get_lodes(lodes_type = "od", years = 2021, states = "MN")
View(test)
View(test2)
View(test)
View(test2)
source("~/GitHub/climateapi/R/get_lodes.R")
test2 <- get_lodes(lodes_type = "od", years = 2021, states = "MN")
test2 <- get_lodes(lodes_type = "wac", years = 2021, states = "MN")
View(lodes_all_jobs)
View(lodes_federal_jobs)
source("~/GitHub/climateapi/R/get_lodes.R")
test3 <- get_lodes(lodes_type = "wac", years = 2021, states = "MN")
source("~/GitHub/climateapi/R/get_lodes.R")
test3 <- get_lodes(lodes_type = "wac", years = 2021, states = "MN")
3004*3004
source("~/GitHub/climateapi/R/get_business_patterns.R")
testthat::test_that("naics_code_digits errors clearly when not in c(2,3)", {
testthat::expect_error({get_business_patterns(year = 2022, naics_code_digits = 4)})
})
testthat::expect_error({get_business_patterns(year = 2022, naics_code_digits = 5)})
testthat::test_that("naics_code_digits errors clearly when not in c(2,3)", {
testthat::expect_error({get_business_patterns(year = 2022, naics_code_digits = 7)})
})
test <- get_business_patterns()
library(tidyverse)
test <- get_business_patterns()
View(test)
test <- get_business_patterns(year = 2025)
source("~/GitHub/climateapi/R/get_business_patterns.R")
test <- get_business_patterns(year = 2025)
test <- get_business_patterns(year = 2025)
normalizePath("~")
file.edit("~/.Rprofile")
test <- get_business_patterns(year = 2025)
options(error = NULL)
test <- get_business_patterns(year = 2025)
test <- get_business_patterns(year = 2025)
View(test)
source("~/GitHub/climateapi/R/get_business_patterns.R")
test <- get_business_patterns(year = 2025)
source("~/GitHub/climateapi/R/get_business_patterns.R")
test <- get_business_patterns()
library(tidycensus)
library(tidyverse)
test <- get_business_patterns()
test <- get_business_patterns(year = 2025)
testthat::test_that("naics_code_digits errors clearly when year is outside accceptable range", {
testthat::expect_error({get_business_patterns(year = 2025, naics_code_digits = 3)})
})
source("~/GitHub/climateapi/tests/testthat/test-get_business_patterns.R")
devtools::test()
library(devtools)
install.packages("devtools")
library(devtools)
devtools::test()
View(test)
test2 <- get_business_patterns()
test2 <- censusapi::listCensusMetadata(
name = "cbp",
vintage = "2022",
type = "variables",
include_values = TRUE)
View(test2)
test3 <- censusapi::getCensus(
name = "cbp",
vintage = 2022,
vars = c(
"EMP",
"ESTAB",
"PAYANN",
"EMPSZES",
"NAICS2017_LABEL"),
region = "zipcode:*",
NAICS2017 = "00")
View(test3)
View(test3)
test3 <- censusapi::getCensus(
name = "cbp",
vintage = 2022,
vars = c(
"EMP",
"ESTAB",
"PAYANN",
"EMPSZES",
"NAICS2017_LABEL"),
region = "zipcode:*",
NAICS2017 = "00")
test3 <- censusapi::getCensus(
name = "cbp",
vintage = 2022,
vars = c(
"EMP", "YEAR",
"ESTAB",
"PAYANN",
"EMPSZES",
"NAICS2017_LABEL"),
region = "zipcode:*",
NAICS2017 = "00")
View(test)
View(test2)
View(test3)
View(test)
source("~/GitHub/climateapi/R/get_business_patterns.R")
test <- get_business_patterns()
source("~/GitHub/climateapi/R/get_business_patterns.R")
test <- get_business_patterns()
View(test)
test2 <- get_business_patterns(geo = "zipcode")
test_zip <-censusapi::getCensus(
name = "cbp",
vintage = 2022,
region = paste0("geo"zipcode, ":*"),
test_zip <-censusapi::getCensus(
name = "cbp",
vintage = 2022,
region = paste0("zipcode", ":*"),
NAICS2017 = "00")
test_zip <-censusapi::getCensus(
name = "cbp",
vintage = 2022,
vars = "all",
region = paste0("zipcode", ":*"),
NAICS2017 = "00")
View(test2)
?censusapi::getCensus
zbp_vars_2022 <- listCensusMetadata(
name    = "zbp",
vintage = 2022,
type    = "variables"
)
zbp_vars_2022 <- censusapi::listCensusMetadata(
name    = "zbp",
vintage = 2022,
type    = "variables"
)
zbp_vars_2022 <- censusapi::listCensusMetadata(
name    = "zbp",
vintage = 2022,
type    = "variables"
)
zbp_vars_2020 <- listCensusMetadata(
name    = "zbp",
vintage = 2020,
type    = "variables"
)
zbp_vars_2020 <- censusapi::listCensusMetadata(
name    = "zbp",
vintage = 2020,
type    = "variables"
)
zbp_vars_2022 <- censusapi::listCensusMetadata(
name    = "zbp",
vintage = 2022,
type    = "variables", include_values = TRUE
)
source("~/GitHub/climateapi/R/get_business_patterns.R")
test_zip <-censusapi::getCensus(
name = "cbp",
vintage = 2022,
vars = "all",
region = paste0("zipcode", ":*"),
NAICS2017 = "00")
test2 <- get_business_patterns(geo = "zipcode")
rlang::last_trace()
source("~/GitHub/climateapi/R/get_business_patterns.R")
test <- get_business_patterns()
source("~/GitHub/climateapi/R/get_business_patterns.R")
test <- get_business_patterns()
source("~/GitHub/climateapi/R/get_business_patterns.R")
test <- get_business_patterns()
test2 <- get_business_patterns(geo = "zipcode")
colnames(test3)
source("~/GitHub/climateapi/R/get_business_patterns.R")
test2 <- get_business_patterns(geo = "zipcode")
View(test2)
source("~/GitHub/climateapi/R/get_business_patterns.R")
test4 <- get_business_patterns(geo = "tract")
source("~/GitHub/climateapi/tests/testthat/test-get_business_patterns.R")
devtools::test()
load_all()
load_all()
devtools::load_all()
devtools::test()
devtools::test()
source("~/GitHub/climateapi/tests/testthat/test-get_business_patterns.R")
testthat::test_that("employees has no negative values", {
test <- get_business_patterns(geo = "county", naics_code_digits = 2)
# Ensure the column exists
testthat::expect_true(
"employees" %in% names(test),
info = "`employees` column is missing in the returned data."
)
# Assert no negative values (ignore NAs)
testthat::expect_true(
all(test$employees[!is.na(test$employees)] >= 0),
info = "Found negative values in `employees`."
)
})
test <- get_business_patterns(geo = "county", naics_code_digits = 2)
source("~/GitHub/climateapi/R/get_business_patterns.R")
test <- get_business_patterns()
test <- get_business_patterns(geo = "zipcode")
source("~/GitHub/climateapi/R/get_business_patterns.R")
test <- get_business_patterns(geo = "zipcode")
rlang::last_trace()
library(tidyverse)
source("~/GitHub/climateapi/R/get_business_patterns.R")
test <- get_business_patterns()
View(test)
devtools::test()
source("~/GitHub/climateapi/tests/testthat/test-get_business_patterns.R")
